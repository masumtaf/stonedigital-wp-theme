let tocId="table-of-contents__nav",headings,headingIds=[],headingIntersectionData={},headerObserver;function setLinkActive(e){document.querySelectorAll("#table-of-contents__nav a").forEach(e=>e.classList.remove("active"));const t=document.querySelectorAll("#table-of-contents__nav .observed");if(t.forEach(e=>e.classList.remove("observed")),e){e.classList.add("active");const t=e.parentElement.parentElement;t.classList.add("observed")}}function getProperListSection(t,n,e){let i=e;if(n){if(t.tagName.slice(-1)>n.tagName.slice(-1))return(e=document.createElement("ul")).classList.add("submenu"),i.appendChild(e),e;if(t.tagName.slice(-1)<n.tagName.slice(-1)){let e=parseInt(n.tagName.slice(-1))-parseInt(t.tagName.slice(-1));for(;0<e;)i=i.parentElement,e--}}return i}function setIdFromContent(e,t){e.id||(e.id=e.innerHTML.replace(/:/g,"").trim().toLowerCase().split(" ").join("-")+"-"+t)}function addNavigationLinkForHeading(e,t){var n=document.createElement("li");let i=document.createElement("a");i.innerHTML=e.innerHTML,i.id=e.id+"-link",i.href="#"+e.id,i.onclick=e=>{setTimeout(()=>{setLinkActive(i)})},n.appendChild(i),t.appendChild(n)}function buildTableOfContentsFromHeadings(){var e=document.querySelector("#"+tocId),t=document.querySelector(".stdl-post-content-left");if(!t)throw Error("A `main` tag section is required to query headings from.");headings=t.querySelectorAll("h1, h2, h3, h4, h5, h6");let n,i=document.createElement("ul");e.appendChild(i),headings.forEach(e=>{e.innerHTML=e.innerHTML.replace(/<strong>/g,"").replace(/<\/strong>/g,"")}),headings.forEach(e=>{e.innerHTML=e.innerHTML.replace(/<em>/g,"").replace(/<\/em>/g,"")}),headings.forEach((e,t)=>{i=getProperListSection(e,n,i),setIdFromContent(e,t),addNavigationLinkForHeading(e,i),headingIds.push(e.id),headingIntersectionData[e.id]={y:0},n=e})}function updateActiveHeadingOnIntersection(e){var t=headingIntersectionData[e.target.id].y,n=e.boundingClientRect.y,i="#"+e.target.id,o=document.querySelector(i+"-link"),a=headingIds.indexOf(e.target.id);e.isIntersecting?t<n&&0!==a?console.log(i+":1 enter top"):(console.log(i+":2 enter bottom"),setLinkActive(o)):t<n?(console.log(i+":3 leave bottom"),setLinkActive(document.querySelector(`#${headingIds[a-1]}-link`))):console.log(i+":4 leave top"),headingIntersectionData[e.target.id].y=n}function observeHeadings(){var e=document.querySelectorAll("h1, h2, h3, h4, h5, h6");const t=new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&(e=document.querySelector(`#table-of-contents__nav a[href='#${e.target.id}']`))&&setLinkActive(e)})},{rootMargin:"0px 0px -75% 0px",threshold:1});e.forEach(e=>t.observe(e))}document.addEventListener("DOMContentLoaded",observeHeadings),window.addEventListener("load",e=>{buildTableOfContentsFromHeadings(),"IntersectionObserver"in window&&observeHeadings()}),window.addEventListener("unload",e=>{headerObserver.disconnect()});